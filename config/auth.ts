import { JWK } from '@jose/jwt';\n\nexport const authConfig = {\n  domain: process.env.AUTH0_DOMAIN,\n  clientId: process.env.AUTH0_CLIENT_ID,\n  clientSecret: process.env.AUTH0_CLIENT_SECRET,\n  audience: process.env.AUTH0_AUDIENCE,\n  issuer: process.env.AUTH0_ISSUER,\n};\n\nexport const verifyAuth0Token = async (token: string) => {\n  try {\n    const jwk = new JWK({\n      kid: authConfig.clientId,\n      iss: authConfig.issuer,\n      exp: new Date().getTime() + 3600000,\n      sub: process.env.AUTH0_SUBj,\n      aud: authConfig.audience,\n    });\n\n    const { payload, signature } = await jwk.verify(token);\n\n    return {\n      isAuth0Token: true,\n      payload,\n      signature,\n    };\n  } catch (err) {\n    console.error('Error verifying Auth0 token:', err);\n    throw new Error('Invalid or expired token');\n  }\n};
